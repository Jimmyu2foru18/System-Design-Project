<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Recspicy</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen flex flex-col">
    <!-- Navigation Bar -->
    <nav id="nav-container"></nav>

    <main class="flex-grow container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-4xl font-bold mb-8">Profile</h1>

            <!-- Profile -->
            <section class="bg-white rounded-lg shadow-lg p-8 mb-8">
                <div class="flex items-center gap-8 mb-8">
                    <img id="profile-picture" class="w-40 h-40 flex items-center rounded-full bg-gray-200 object-cover border-4 border-blue-500 p-2" src="default-profile.jpg" alt="Profile Picture">
                    <div>
                        <h2 id="profile-name" class="text-2xl font-bold"></h2>
                        <p id="member-since" class="text-gray-600"></p>
                    </div>
                </div>

                <div class="space-y-6 form-input w-full border-4 border-blue-500 rounded-full p-2">
                    <p><strong>Email:</strong> <span id="email"></span></p>
				</div>
				<div class="space-y-6 form-input w-full border-4 border-blue-500 rounded-full p-2">
                    <p><strong>Bio:</strong> <span id="bio"></span></p>
                </div>
            </section>

            <!-- User's Public/Private Recipes. Will be implemented in future -->
            <section class="bg-white rounded-lg shadow-lg border-4 border-blue-500 p-8">
                <h2 class="text-2xl font-bold mb-6">Recipes</h2>
                <div class="grid md:grid-cols-2 gap-6" id="user-recipes">
                    <!-- 
					Recipe cards the user creates will be here it will be private to the 
					user first or if shared publiclly it will add to our database with the users name attached 
					directing to their profile for recipies and it will both be oon there profile and 
					within our recipe database 
					-->
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <div id="footer-container"></div>

    <!-- Scripts -->
    <script src="navigation.js"></script>
	
    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const userId = urlParams.get("id");
                const response = await fetch(`/api/profile?id=${userId}`);
                const userData = await response.json();
                
                document.getElementById("profile-name").textContent = `${userData.firstName} ${userData.lastName}`;
                document.getElementById("member-since").textContent = `Member since ${userData.joinDate}`;
                document.getElementById("email").textContent = userData.email;
                document.getElementById("bio").textContent = userData.bio || "No bio available.";
                if (userData.profilePicture) {
                    document.getElementById("profile-picture").src = userData.profilePicture;
                }
                loadUserRecipes(userData.recipes);
            } catch (error) {
                console.error("Error loading profile data:", error);
            }
        });

        function loadUserRecipes(recipes) {
            const recipesContainer = document.getElementById("user-recipes");
            recipesContainer.innerHTML = "";
            recipes.forEach(recipe => {
                const card = document.createElement("div");
                card.className = "recipe-card w-72 bg-gray-100 p-4 rounded-lg shadow";
                card.innerHTML = `
                    <h3 class="text-lg font-bold">${recipe.title}</h3>
                    <p class="text-gray-600 text-sm">${recipe.description}</p>
                    <a href="recipe-detail.html?id=${recipe.id}" class="text-blue-600 hover:underline">View Recipe</a>
                `;
                recipesContainer.appendChild(card);
            });
        }
    </script>
</body>
</html>
